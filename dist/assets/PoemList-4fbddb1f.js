import{u as S,a as z,r as u,o as U,c as C,b as j,d as o,e as l,f as s,w as c,v as p,F as f,g as k,h as V,i as g,t as d,n as D,j as x,B as L,k as B,l as q}from"./index-bafae1ff.js";import{H}from"./heart-5e676e29.js";const M={class:"mb-6 flex flex-wrap gap-4"},T={class:"w-full md:w-auto"},$={key:0,class:"w-full md:w-auto"},A=["value"],E={key:1,class:"w-full md:w-auto"},R=["value"],G={class:"w-full md:w-auto ml-auto"},J={key:0,class:"text-center py-10"},K={key:1,class:"text-center py-10"},O={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Q={class:"text-xl font-kai mb-2"},W={class:"text-gray-600 dark:text-gray-400 mb-4"},X={class:"text-gray-700 dark:text-gray-300 mb-4 line-clamp-3"},Y={class:"flex justify-between items-center"},Z={class:"flex items-center"},I=["onClick"],ee={class:"flex items-center text-gray-600 dark:text-gray-400"},oe={__name:"PoemList",setup(te){const w=S(),r=z(),b=u(!0),i=u("all"),v=u(""),m=u(""),y=u("likes");U(async()=>{w.query.filter&&(i.value=w.query.filter),r.poems.length===0&&await r.fetchPoems(),r.poets.length===0&&await r.fetchPoets(),b.value=!1});const F=C(()=>[...new Set(r.poems.map(a=>a.dynasty))]),_=C(()=>{let a=[...r.poems];return i.value==="dynasty"&&v.value&&(a=a.filter(e=>e.dynasty===v.value)),i.value==="author"&&m.value&&(a=a.filter(e=>e.author===m.value)),y.value==="likes"?a.sort((e,n)=>n.likes-e.likes):y.value==="title"&&a.sort((e,n)=>e.title.localeCompare(n.title,"zh-CN")),a}),N=a=>{r.isPoemFavorited(a)?r.unfavoritePoem(a):r.favoritePoem(a)},h=a=>r.isPoemFavorited(a);return(a,e)=>{const n=j("router-link");return o(),l("div",null,[e[11]||(e[11]=s("h1",{class:"text-3xl font-kai text-primary dark:text-dark-primary mb-6"},"诗歌列表",-1)),s("div",M,[s("div",T,[c(s("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>i.value=t),class:"w-full md:w-auto px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},[...e[4]||(e[4]=[s("option",{value:"all"},"全部",-1),s("option",{value:"dynasty"},"按朝代",-1),s("option",{value:"author"},"按作者",-1)])],512),[[p,i.value]])]),i.value==="dynasty"?(o(),l("div",$,[c(s("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>v.value=t),class:"w-full md:w-auto px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},[e[5]||(e[5]=s("option",{value:""},"选择朝代",-1)),(o(!0),l(f,null,k(F.value,t=>(o(),l("option",{key:t,value:t},d(t),9,A))),128))],512),[[p,v.value]])])):V("",!0),i.value==="author"?(o(),l("div",E,[c(s("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>m.value=t),class:"w-full md:w-auto px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},[e[6]||(e[6]=s("option",{value:""},"选择作者",-1)),(o(!0),l(f,null,k(g(r).poets,t=>(o(),l("option",{key:t.id,value:t.name},d(t.name),9,R))),128))],512),[[p,m.value]])])):V("",!0),s("div",G,[c(s("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>y.value=t),class:"w-full md:w-auto px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},[...e[7]||(e[7]=[s("option",{value:"likes"},"按热度排序",-1),s("option",{value:"title"},"按标题排序",-1)])],512),[[p,y.value]])])]),b.value?(o(),l("div",J,[...e[8]||(e[8]=[s("p",null,"加载中...",-1)])])):_.value.length===0?(o(),l("div",K,[...e[9]||(e[9]=[s("p",null,"没有找到符合条件的诗歌",-1)])])):(o(),l("div",O,[(o(!0),l(f,null,k(_.value,t=>(o(),l("div",{key:t.id,class:"poem-card bg-white dark:bg-gray-800"},[s("h2",Q,d(t.title),1),s("p",W,d(t.dynasty)+" · "+d(t.author),1),s("p",X,d(t.content.map(P=>P.sentence).join(" ")),1),s("div",Y,[s("div",Z,[s("button",{onClick:P=>N(t.id),class:D(["mr-4 focus:outline-none",{"text-yellow-500":h(t.id),"text-gray-400":!h(t.id)}])},[x(g(L),{size:"18"})],10,I),s("span",ee,[x(g(H),{size:"18",class:"mr-1 text-red-500"}),B(" "+d(t.likes),1)])]),x(n,{to:`/poem/${t.id}`,class:"btn btn-primary text-sm"},{default:q(()=>[...e[10]||(e[10]=[B(" 查看详情 ",-1)])]),_:1},8,["to"])])]))),128))]))])}}};export{oe as default};
