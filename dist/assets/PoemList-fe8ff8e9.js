import{u as N,a as S,r as m,o as z,c as C,b as U,d as o,e as r,f as a,w as f,v as k,F as p,g,h as V,i as x,t as i,n as j,j as w,B as D,k as q,l as L}from"./index-a1124cd9.js";import{H}from"./heart-47223e59.js";const M={class:"mb-6 flex flex-wrap gap-4"},T={class:"w-full md:w-auto"},$={key:0,class:"w-full md:w-auto"},A=["value"],E={key:1,class:"w-full md:w-auto"},R=["value"],G={class:"w-full md:w-auto ml-auto"},J={key:0,class:"text-center py-10"},K={key:1,class:"text-center py-10"},O={key:2,class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6"},Q={class:"text-xl font-kai mb-2"},W={class:"text-gray-600 dark:text-gray-400 mb-4"},X={class:"text-gray-700 dark:text-gray-300 mb-4 line-clamp-3"},Y={class:"flex justify-between items-center"},Z={class:"flex items-center"},I=["onClick"],ee={class:"flex items-center text-gray-600 dark:text-gray-400"},oe={__name:"PoemList",setup(te){const n=N(),l=S(),b=m(!0),d=m("all"),u=m(""),y=m(""),c=m("likes");z(async()=>{await l.fetchPoems(!0),await l.fetchPoets(!0),n.query.filter&&(d.value=n.query.filter,d.value==="dynasty"&&n.query.dynasty&&(u.value=n.query.dynasty),d.value==="author"&&n.query.author&&(y.value=n.query.author)),b.value=!1});const B=C(()=>[...new Set(l.poems.map(s=>s.dynasty))]),_=C(()=>{let s=[...l.poems];return d.value==="dynasty"&&u.value&&(s=s.filter(e=>e.dynasty===u.value)),d.value==="author"&&y.value&&(s=s.filter(e=>e.author===y.value)),c.value==="likes"?s.sort((e,v)=>v.likes-e.likes):c.value==="title"&&s.sort((e,v)=>e.title.localeCompare(v.title,"zh-CN")),s}),F=s=>{l.isPoemFavorited(s)?l.unfavoritePoem(s):l.favoritePoem(s)},h=s=>l.isPoemFavorited(s);return(s,e)=>{const v=U("router-link");return o(),r("div",null,[e[11]||(e[11]=a("h1",{class:"text-3xl font-kai text-primary dark:text-dark-primary mb-6"},"诗歌列表",-1)),a("div",M,[a("div",T,[f(a("select",{"onUpdate:modelValue":e[0]||(e[0]=t=>d.value=t),class:"w-full md:w-auto px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},[...e[4]||(e[4]=[a("option",{value:"all"},"全部",-1),a("option",{value:"dynasty"},"按朝代",-1),a("option",{value:"author"},"按作者",-1)])],512),[[k,d.value]])]),d.value==="dynasty"?(o(),r("div",$,[f(a("select",{"onUpdate:modelValue":e[1]||(e[1]=t=>u.value=t),class:"w-full md:w-auto px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},[e[5]||(e[5]=a("option",{value:""},"选择朝代",-1)),(o(!0),r(p,null,g(B.value,t=>(o(),r("option",{key:t,value:t},i(t),9,A))),128))],512),[[k,u.value]])])):V("",!0),d.value==="author"?(o(),r("div",E,[f(a("select",{"onUpdate:modelValue":e[2]||(e[2]=t=>y.value=t),class:"w-full md:w-auto px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},[e[6]||(e[6]=a("option",{value:""},"选择作者",-1)),(o(!0),r(p,null,g(x(l).poets,t=>(o(),r("option",{key:t.id,value:t.name},i(t.name),9,R))),128))],512),[[k,y.value]])])):V("",!0),a("div",G,[f(a("select",{"onUpdate:modelValue":e[3]||(e[3]=t=>c.value=t),class:"w-full md:w-auto px-4 py-2 rounded-md border border-gray-300 dark:border-gray-600 dark:bg-gray-700 dark:text-white"},[...e[7]||(e[7]=[a("option",{value:"likes"},"按热度排序",-1),a("option",{value:"title"},"按标题排序",-1)])],512),[[k,c.value]])])]),b.value?(o(),r("div",J,[...e[8]||(e[8]=[a("p",null,"加载中...",-1)])])):_.value.length===0?(o(),r("div",K,[...e[9]||(e[9]=[a("p",null,"没有找到符合条件的诗歌",-1)])])):(o(),r("div",O,[(o(!0),r(p,null,g(_.value,t=>(o(),r("div",{key:t.id,class:"poem-card bg-white dark:bg-gray-800"},[a("h2",Q,i(t.title),1),a("p",W,i(t.dynasty)+" · "+i(t.author),1),a("p",X,i(t.content.map(P=>P.sentence).join(" ")),1),a("div",Y,[a("div",Z,[a("button",{onClick:P=>F(t.id),class:j(["mr-4 focus:outline-none",{"text-yellow-500":h(t.id),"text-gray-400":!h(t.id)}])},[w(x(D),{size:"18"})],10,I),a("span",ee,[w(x(H),{size:"18",class:"mr-1 text-red-500"}),q(" "+i(t.likes),1)])]),w(v,{to:`/poem/${t.id}`,class:"btn btn-primary text-sm"},{default:L(()=>[...e[10]||(e[10]=[q(" 查看详情 ",-1)])]),_:1},8,["to"])])]))),128))]))])}}};export{oe as default};
