import{u as C,a as F,r as h,c as B,s as H,o as L,b as N,d as r,e as n,f as t,t as l,F as x,g as k,h as R,n as S,j as y,i as f,B as V,k as p,l as z}from"./index-2ebfb53d.js";import{H as M}from"./heart-9784c3c5.js";const T={class:"mb-6"},$={class:"text-gray-600 dark:text-gray-400"},j={key:0,class:"text-center py-10"},q={key:1,class:"text-center py-10"},E={key:2,class:"space-y-6"},D={class:"text-xl font-kai mb-2"},K={class:"text-gray-600 dark:text-gray-400 mb-4"},Q={class:"text-gray-700 dark:text-gray-300 mb-4"},A=["innerHTML"],G={key:0},J={class:"flex justify-between items-center"},O={class:"flex items-center"},U=["onClick"],W={class:"flex items-center text-gray-600 dark:text-gray-400"},I={__name:"SearchResults",setup(X){const b=C(),o=F(),u=h(!0),i=h([]),c=B(()=>b.query.q||""),_=()=>{c.value?i.value=o.searchPoems(c.value):i.value=[],u.value=!1},w=(a,s)=>{if(!s)return a;const d=new RegExp(s,"gi");return a.replace(d,e=>`<span class="bg-yellow-200 dark:bg-yellow-700">${e}</span>`)},P=a=>{o.isPoemFavorited(a)?o.unfavoritePoem(a):o.favoritePoem(a)},m=a=>o.isPoemFavorited(a);return H(c,()=>{u.value=!0,_()}),L(async()=>{o.poems.length===0&&await o.fetchPoems(),_()}),(a,s)=>{const d=N("router-link");return r(),n("div",null,[s[3]||(s[3]=t("h1",{class:"text-3xl font-kai text-primary dark:text-dark-primary mb-6"},"搜索结果",-1)),t("div",T,[t("p",$,' 关键词 "'+l(c.value)+'" 的搜索结果：共找到 '+l(i.value.length)+" 条结果 ",1)]),u.value?(r(),n("div",j,[...s[0]||(s[0]=[t("p",null,"搜索中...",-1)])])):i.value.length===0?(r(),n("div",q,[...s[1]||(s[1]=[t("p",null,"没有找到符合条件的诗歌",-1)])])):(r(),n("div",E,[(r(!0),n(x,null,k(i.value,e=>(r(),n("div",{key:e.id,class:"poem-card bg-white dark:bg-gray-800"},[t("h2",D,l(e.title),1),t("p",K,l(e.dynasty)+" · "+l(e.author),1),t("p",Q,[(r(!0),n(x,null,k(e.content,(g,v)=>(r(),n("span",{key:v},[t("span",{innerHTML:w(g.sentence,c.value)},null,8,A),v<e.content.length-1?(r(),n("br",G)):R("",!0)]))),128))]),t("div",J,[t("div",O,[t("button",{onClick:g=>P(e.id),class:S(["mr-4 focus:outline-none",{"text-yellow-500":m(e.id),"text-gray-400":!m(e.id)}])},[y(f(V),{size:"18"})],10,U),t("span",W,[y(f(M),{size:"18",class:"mr-1 text-red-500"}),p(" "+l(e.likes),1)])]),y(d,{to:`/poem/${e.id}`,class:"btn btn-primary text-sm"},{default:z(()=>[...s[2]||(s[2]=[p(" 查看详情 ",-1)])]),_:1},8,["to"])])]))),128))]))])}}};export{I as default};
